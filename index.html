<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Jack Ma</title>
    <style>
        .box, .content, .avatar, .name, .intro, .links, .link-box {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .background, .box {
            position: absolute;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;
        }
        .background {
            overflow: hidden;
        }
        .background-mask {
            position: absolute;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(140deg, rgba(68,68,68,0.6) 20%, rgba(0,0,0,0.9));
            background-color: rgba(68,68,68,0.6);
        }
        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50px;
            overflow: hidden;
        }
        #avatar-img{
            width: 100%;
            height: 100%;
        }
        .interval {
            height: 1px;
            background-color: rgba(255,255,255,0.14);
            margin: 20px auto;
        }
        #interval-1 {
            width: 200px;
        } 
        #interval-2 {
            width: 100px;
        }
        .name {
            margin-top: 20px;
            color: white;
            font-size: 2.5em;
            letter-spacing: 4px;
            text-decoration: none;
        }
        .intro div, .intro a {
            font-size: 0.9em;
            color: white;
            margin: 2px;
            text-decoration: none;
        }
        .link-box {
            width: 36px;
            height: 36px;
            border-radius: 18px;
            overflow: hidden;
            border: 1px solid white;
            opacity: 0.8;
        }
        .link-img {
            width: 60%;
            height: 60%;
        }
        @media only screen and (min-width: 700px) {
            .intro {
                flex-direction: row;
            }
        }
    </style>
</head>
<body>
    <div class="background">
        <img id="background-img"/>
        <div class="background-mask"></div>
    </div>
    <div class="box">
        <div class="content">
            <a class="avatar" href="https://jackma01.github.io/">
                <img id="avatar-img" src="./src/img/avatar/avatar.png"/>
            </a>
            <a class="name" href="https://jackma01.github.io/">
                Jack Ma
            </a>
            <div class="interval" id="interval-1"></div>
            <div class="intro">
                <div>Senior undergraduate student at</div>
                <a href="https://www.hust.edu.cn/">Huazhong University of Science and Technology</a>
            </div>
            <div class="interval" id="interval-2"></div>
            <div class="links">
                <a class="link-box" id="link-box-1" href="https://github.com/JackMa01">
                    <img class="link-img" src="./src/img/icon/github.png"/>
                </a>
            </div>
        </div>
    </div>
</body>
<script>
    var background_image_dataset = null
    var chosen_bg_image = null  // avalible for test

    function resizeBackground() {
        var centerX = $(window).width() * 0.5
        var centerY = $(window).height() * 0.5
        var window_ratio = $(window).width() / $(window).height()
        var background_img_ratio = $("#background-img").width() / $("#background-img").height()

        if (background_img_ratio >= window_ratio) {
            $("#background-img").css("height", "100%")
            $("#background-img").css("width", "auto")

            var anchorX = $("#background-img").width() * chosen_bg_image.anchorX
            $("#background-img").css("transform", "translateX(" + ((centerX - anchorX) < 0 ? (centerX - anchorX) : 0) + "px)")
        } else {
            $("#background-img").css("width", "100%")
            $("#background-img").css("height", "auto")

            var anchorY = $("#background-img").height() * chosen_bg_image.anchorY
            $("#background-img").css("transform", "translateY(" + ((centerY - anchorY) < 0 ? (centerY - anchorY) : 0) +"px)")
        }
    }

    function linkBoxAddMouseEvents(id) {
        $(id).mouseenter(function() {
            $(id).animate({opacity: 1}, 500, "linear", function() {
                $(id).css("opacity", 1)
            })
        })
        $(id).mouseleave(function() {
            $(id).animate({opacity: 0.8}, 100, "linear", function() {
                $(id).css("opacity", 0.8)
            })
        })
    }

    function chooseBackgroundImage(dataset) {
        var rand = parseInt(Math.random() * dataset.length)
        chosen_bg_image = chosen_bg_image || background_image_dataset[dataset[rand]]
        $("#background-img").attr("src", chosen_bg_image.relative_path)
    }

    $(document).ready(function() {
        $.ajaxSettings.async = false
        background_image_dataset = $.getJSON("./src/json/background_image.json").responseJSON
        $.ajaxSettings.async = true

        chooseBackgroundImage(background_image_dataset.data)
        linkBoxAddMouseEvents("#link-box-1")
    })
    $(window).on("load", function() {
        resizeBackground()
    })
    $(window).resize(function() {
        resizeBackground()
    })
</script>
</html>